{"ast":null,"code":"import { Router } from '@angular/router';\nimport { CartService } from '../../services/cart.service';\nimport { OrdersService } from '../../services/order.service';\nimport { CartItemDetails } from '../../models/cart';\nimport { Subject, takeUntil } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../services/cart.service\";\nimport * as i3 from \"../../services/order.service\";\nconst _c0 = function (a0) {\n  return {\n    \"height\": a0\n  };\n};\nfunction CartPageComponent_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 7)(1, \"div\", 1)(2, \"div\", 8);\n    i0.ɵɵelement(3, \"img\", 9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 10)(5, \"div\", 11);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\", 12);\n    i0.ɵɵtext(8);\n    i0.ɵɵpipe(9, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"div\", 13)(11, \"p-button\", 14);\n    i0.ɵɵlistener(\"onClick\", function CartPageComponent_div_10_Template_p_button_onClick_11_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r3);\n      const cartItem_r1 = restoredCtx.$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.deleteCartItem(cartItem_r1.product));\n    });\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(12, \"div\", 10)(13, \"div\", 15)(14, \"p-inputNumber\", 16);\n    i0.ɵɵlistener(\"ngModelChange\", function CartPageComponent_div_10_Template_p_inputNumber_ngModelChange_14_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r3);\n      const cartItem_r1 = restoredCtx.$implicit;\n      return i0.ɵɵresetView(cartItem_r1.quantity = $event);\n    })(\"onInput\", function CartPageComponent_div_10_Template_p_inputNumber_onInput_14_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r3);\n      const cartItem_r1 = restoredCtx.$implicit;\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.updateCartItemQuantity($event, cartItem_r1.product));\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(15, \"div\", 17);\n    i0.ɵɵtext(16, \" Subtotal : \");\n    i0.ɵɵelementStart(17, \"span\", 18);\n    i0.ɵɵtext(18);\n    i0.ɵɵpipe(19, \"currency\");\n    i0.ɵɵelementEnd()()()()();\n  }\n  if (rf & 2) {\n    const cartItem_r1 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction1(17, _c0, ctx_r0.getScreenWidth < 550 ? \"75px\" : \"120px\"))(\"src\", cartItem_r1.product.product.image, i0.ɵɵsanitizeUrl)(\"routerLink\", \"/products/\" + cartItem_r1.product.product.id);\n    i0.ɵɵattribute(\"alt\", cartItem_r1.product.product.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"routerLink\", \"/products/\" + cartItem_r1.product.product.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", cartItem_r1.product.product.name, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(9, 13, cartItem_r1.product.product.price), \" \");\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"showButtons\", true)(\"inputId\", cartItem_r1.product.product.id)(\"min\", 1)(\"max\", 100)(\"ngModel\", cartItem_r1.quantity);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(19, 15, cartItem_r1.product.product.price * cartItem_r1.quantity), \" \");\n  }\n}\nexport let CartPageComponent = /*#__PURE__*/(() => {\n  class CartPageComponent {\n    constructor(router, cartService, ordersService) {\n      this.router = router;\n      this.cartService = cartService;\n      this.ordersService = ordersService;\n      this.cartItemsDetails = [];\n      this.cartCount = 0;\n      this.endSubs$ = new Subject();\n    }\n    ngOnInit() {\n      this._getCartDetails();\n      this.getScreenWidth = window.innerWidth;\n    }\n    ngOnDestroy() {\n      this.endSubs$.complete();\n    }\n    backToShop() {\n      this.router.navigate(['/products']);\n    }\n    deleteCartItem(cartItem) {\n      this.cartService.deleteCartItem(cartItem.product.id);\n    }\n    _getCartDetails() {\n      this.cartService.cart$.pipe(takeUntil(this.endSubs$)).subscribe(respCart => {\n        this.cartItemsDetails = [];\n        this.cartCount = respCart?.items.length ?? 0;\n        respCart.items.forEach(cartItem => {\n          if (cartItem.productId) {\n            this.ordersService.getProduct(cartItem.productId).subscribe(respProduct => {\n              this.cartItemsDetails.push({\n                product: respProduct,\n                quantity: cartItem.quantity\n              });\n            });\n          }\n        });\n      });\n    }\n    // updateCartItemQuantity(event, cartItem: CartItemDetails) {\n    //   this.cartService.setCartItem(\n    //     {\n    //       productId: cartItem.product.id,\n    //       quantity: event.value,\n    //     },\n    //     true\n    //   );\n    // }\n    updateCartItemQuantity(event, cartItem) {\n      this.cartService.setCartItem({\n        productId: cartItem.product.id,\n        quantity: event.value\n      }, true);\n    }\n    onWindowResize() {\n      this.getScreenWidth = window.innerWidth;\n    }\n  }\n  CartPageComponent.ɵfac = function CartPageComponent_Factory(t) {\n    return new (t || CartPageComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.CartService), i0.ɵɵdirectiveInject(i3.OrdersService));\n  };\n  CartPageComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CartPageComponent,\n    selectors: [[\"orders-cart-page\"]],\n    hostBindings: function CartPageComponent_HostBindings(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵlistener(\"resize\", function CartPageComponent_resize_HostBindingHandler($event) {\n          return ctx.onWindowResize($event);\n        }, false, i0.ɵɵresolveWindow);\n      }\n    },\n    decls: 13,\n    vars: 2,\n    consts: [[1, \"cart-page\"], [1, \"grid\"], [1, \"col-8\"], [\"label\", \"Continue shopping\", \"icon\", \"pi pi-arrow-left\", 3, \"onClick\"], [1, \"cart-shipping\"], [\"class\", \"cart-item\", 4, \"ngFor\", \"ngForOf\"], [1, \"col-4\"], [1, \"cart-item\"], [1, \"col-2\", \"cart-item-image\"], [3, \"ngStyle\", \"src\", \"routerLink\"], [1, \"col-5\"], [1, \"cart-item-name\", 3, \"routerLink\"], [1, \"cart-item-price\"], [1, \"cart-item-remove\"], [\"icon\", \"pi pi-trash\", 3, \"onClick\"], [1, \"field\", \"cart-item-quantity\", \"p-fluid\"], [\"mode\", \"decimal\", 3, \"showButtons\", \"inputId\", \"min\", \"max\", \"ngModel\", \"ngModelChange\", \"onInput\"], [1, \"cart-item-subtotal\"], [1, \"cart-item-subtotal-value\"]],\n    template: function CartPageComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\")(4, \"p-button\", 3);\n        i0.ɵɵlistener(\"onClick\", function CartPageComponent_Template_p_button_onClick_4_listener() {\n          return ctx.backToShop();\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(5, \"div\")(6, \"h4\");\n        i0.ɵɵtext(7);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(8, \"div\", 4);\n        i0.ɵɵtext(9, \" Shipping after the payment , Delivery time 3-7 working days. \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(10, CartPageComponent_div_10_Template, 20, 19, \"div\", 5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"div\", 6);\n        i0.ɵɵelement(12, \"ng-shop-order-summary\");\n        i0.ɵɵelementEnd()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(7);\n        i0.ɵɵtextInterpolate1(\"My Cart: \", ctx.cartCount, \" items(s)\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngForOf\", ctx.cartItemsDetails);\n      }\n    },\n    encapsulation: 2\n  });\n  return CartPageComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}